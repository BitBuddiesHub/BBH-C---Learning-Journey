# 多维数组详解

## 1. 什么是多维数组？

多维数组是一种在程序中存储和操作多维数据的结构。它可以被看作是一个“数组的数组”，例如：
- **一维数组**: 一行数据。
- **二维数组**: 表格或矩阵形式的数据。
- **三维及以上数组**: 具有更多维度的数据结构，通常用于复杂的数据表示（如 3D 模型、图像处理）。

---

## 2. 多维数组的声明与初始化

### 2.1 声明多维数组

**语法**:
```c
type array_name[size1][size2]...[sizeN];
```
- `type`: 数组元素的数据类型（如 `int`、`float`）。
- `array_name`: 数组的名称。
- `size1, size2, ..., sizeN`: 每个维度的大小。

**示例**:
- **二维数组**:
  ```c
  int matrix[3][4]; // 一个 3 行 4 列的二维数组
  ```
- **三维数组**:
  ```c
  float tensor[2][3][4]; // 一个 2x3x4 的三维数组
  ```

---

### 2.2 初始化多维数组

**静态初始化**:
在定义时赋值，可以按行或直接赋值整个数组。
```c
// 二维数组初始化
int matrix[2][3] = {
    {1, 2, 3},
    {4, 5, 6}
};

// 三维数组初始化
int tensor[2][2][2] = {
    {{1, 2}, {3, 4}},
    {{5, 6}, {7, 8}}
};
```

**动态赋值**:
通过索引逐一赋值。
```c
int matrix[2][3];
matrix[0][0] = 1;
matrix[0][1] = 2;
// 依次赋值...
```

---

## 3. 多维数组的访问

数组的元素通过索引访问，每个维度使用一对 `[]`。
- **二维数组**:
  ```c
  int value = matrix[1][2]; // 访问第 2 行第 3 列的元素
  ```
- **三维数组**:
  ```c
  float value = tensor[0][1][2]; // 访问第 1 层第 2 行第 3 列的元素
  ```

---

## 4. 多维数组的内存布局

C 中的多维数组在内存中是以 **行优先顺序（Row-Major Order）** 存储的：
- **行优先顺序**: 先存储同一行的所有列，再存储下一行。
  
**示例**:
```c
int matrix[2][3] = {
    {1, 2, 3},
    {4, 5, 6}
};
```
内存布局如下：
```
地址: matrix[0][0], matrix[0][1], matrix[0][2], matrix[1][0], matrix[1][1], matrix[1][2]
内容: 1          , 2          , 3          , 4          , 5          , 6
```

---

## 5. 使用多维数组的场景

### 5.1 表格数据
二维数组常用于存储表格数据。
```c
int grades[5][3] = {
    {85, 90, 78},
    {88, 92, 80},
    {84, 85, 89},
    {90, 88, 91},
    {82, 87, 85}
};
```

### 5.2 矩阵运算
二维数组适合用于矩阵相关的数学运算。

**矩阵乘法示例**:
```c
#include <stdio.h>

#define ROW1 2
#define COL1 3
#define ROW2 3
#define COL2 2

int main() {
    int matrix1[ROW1][COL1] = {
        {1, 2, 3},
        {4, 5, 6}
    };

    int matrix2[ROW2][COL2] = {
        {7, 8},
        {9, 10},
        {11, 12}
    };

    int result[ROW1][COL2] = {0};

    // 矩阵乘法
    for (int i = 0; i < ROW1; i++) {
        for (int j = 0; j < COL2; j++) {
            for (int k = 0; k < COL1; k++) {
                result[i][j] += matrix1[i][k] * matrix2[k][j];
            }
        }
    }

    // 输出结果
    for (int i = 0; i < ROW1; i++) {
        for (int j = 0; j < COL2; j++) {
            printf("%d ", result[i][j]);
        }
        printf("\n");
    }

    return 0;
}
```

### 5.3 图像处理
三维数组常用于表示 RGB 图像数据。
```c
unsigned char image[480][640][3]; // 480x640 的彩色图像，每个像素有 3 个通道（RGB）
```

---

## 6. 常见问题与注意事项

### 6.1 边界检查
访问数组时索引超出范围会导致未定义行为：
```c
int matrix[3][4];
matrix[3][0] = 10; // 错误，超出数组边界
```

### 6.2 内存使用
多维数组占用的内存为所有维度大小的乘积：
```c
int matrix[100][100]; // 占用 100 * 100 * sizeof(int) 字节
```

### 6.3 初始化问题
未显式初始化的数组元素将包含随机值（如果未使用 `static` 修饰）。

---

## 7. 动态分配多维数组

多维数组也可以通过动态内存分配来实现，特别是在数组大小只有在运行时才能确定时。

**动态分配二维数组示例**:
```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    int rows = 3, cols = 4;

    // 分配行指针数组
    int **matrix = (int **)malloc(rows * sizeof(int *));
    for (int i = 0; i < rows; i++) {
        matrix[i] = (int *)malloc(cols * sizeof(int));
    }

    // 初始化
    for (int i = 0; i < rows; i++) {
        for (int j = 0; j < cols; j++) {
            matrix[i][j] = i * cols + j;
        }
    }

    // 打印
    for (int i = 0; i < rows; i++) {
        for (int j = 0; j < cols; j++) {
            printf("%d ", matrix[i][j]);
        }
        printf("\n");
    }

    // 释放内存
    for (int i = 0; i < rows; i++) {
        free(matrix[i]);
    }
    free(matrix);

    return 0;
}
```

---

## 8. 总结

- **多维数组** 是一种适合表示表格、矩阵、图像等结构的数据存储方式。
- **声明与初始化**: 可以静态初始化或动态赋值。
- **内存布局**: C 中使用行优先顺序存储数据。
- **动态分配**: 对于运行时大小不确定的数组，可以使用动态内存分配。

多维数组为程序的复杂数据结构操作提供了强大的支持，但使用时需注意边界检查和内存管理。
